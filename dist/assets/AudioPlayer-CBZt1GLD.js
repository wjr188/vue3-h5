import{d as ie,Z as Pe,$ as be,m as u,G as Se,a0 as Ve,P as he,a1 as Te,a2 as j,a3 as Ae,a4 as Ne,a5 as Ie,a6 as le,a7 as Ue,n as Be,a8 as Le,Q as _e,a9 as ve,aa as oe,r as d,ab as Re,q as E,ac as $e,ad as Fe,ae as Me,af as me,ag as ze,ah as fe,ai as Ee,aj as Oe,ak as De,al as He,u as Ke,y as Xe,k as Ye,c as W,a as q,b as e,t as _,z as G,x as R,l as $,F as je,e as We,w as qe,M as I}from"./index-CKjozqaQ.js";/* empty css              */import{_ as Ge}from"./back3-q87-H97k.js";import{_ as Qe}from"./share2-DEdzc1xC.js";import{a as ge}from"./audiodetail-COETxsht.js";import{B as Ze}from"./index-BvDqeyKw.js";import{_ as Je}from"./_plugin-vue_export-helper-DlAUqK2U.js";const[et,w]=be("action-sheet"),tt=Pe({},Te,{title:String,round:j,actions:Ne(),closeIcon:Ae("cross"),closeable:j,cancelText:String,description:String,closeOnPopstate:j,closeOnClickAction:Boolean,safeAreaInsetBottom:j}),nt=[...Ie,"round","closeOnPopstate","safeAreaInsetBottom"];var st=ie({name:et,props:tt,emits:["select","cancel","update:show"],setup(s,{slots:m,emit:P}){const l=i=>P("update:show",i),a=()=>{l(!1),P("cancel")},g=()=>{if(s.title)return u("div",{class:w("header")},[s.title,s.closeable&&u(le,{name:s.closeIcon,class:[w("close"),Ue],onClick:a},null)])},S=()=>{if(m.cancel||s.cancelText)return[u("div",{class:w("gap")},null),u("button",{type:"button",class:w("cancel"),onClick:a},[m.cancel?m.cancel():s.cancelText])]},V=i=>{if(i.icon)return u(le,{class:w("item-icon"),name:i.icon},null)},h=(i,p)=>i.loading?u(Le,{class:w("loading-icon")},null):m.action?m.action({action:i,index:p}):[u("span",{class:w("name")},[i.name]),i.subname&&u("div",{class:w("subname")},[i.subname])],C=(i,p)=>{const{color:U,loading:T,callback:A,disabled:N,className:F}=i,B=()=>{N||T||(A&&A(i),s.closeOnClickAction&&l(!1),Be(()=>P("select",i,p)))};return u("button",{type:"button",style:{color:U},class:[w("item",{loading:T,disabled:N}),F],onClick:B},[V(i),h(i,p)])},y=()=>{if(s.description||m.description){const i=m.description?m.description():s.description;return u("div",{class:w("description")},[i])}};return()=>u(he,Se({class:w(),position:"bottom","onUpdate:show":l},Ve(s,nt)),{default:()=>{var i;return[g(),y(),u("div",{class:w("content")},[s.actions.map(C),(i=m.default)==null?void 0:i.call(m)]),S()]}})}});const at=_e(st),[ot,X]=be("slider"),lt={min:oe(0),max:oe(100),step:oe(1),range:Boolean,reverse:Boolean,disabled:Boolean,readonly:Boolean,vertical:Boolean,barHeight:ve,buttonSize:ve,activeColor:String,inactiveColor:String,modelValue:{type:[Number,Array],default:0}};var it=ie({name:ot,props:lt,emits:["change","dragEnd","dragStart","update:modelValue"],setup(s,{emit:m,slots:P}){let l,a,g;const S=d(),V=[d(),d()],h=d(),C=Re(),y=E(()=>Number(s.max)-Number(s.min)),i=E(()=>{const t=s.vertical?"width":"height";return{background:s.inactiveColor,[t]:$e(s.barHeight)}}),p=t=>s.range&&Array.isArray(t),U=()=>{const{modelValue:t,min:o}=s;return p(t)?`${(t[1]-t[0])*100/y.value}%`:`${(t-Number(o))*100/y.value}%`},T=()=>{const{modelValue:t,min:o}=s;return p(t)?`${(t[0]-Number(o))*100/y.value}%`:"0%"},A=E(()=>{const o={[s.vertical?"height":"width"]:U(),background:s.activeColor};h.value&&(o.transition="none");const v=()=>s.vertical?s.reverse?"bottom":"top":s.reverse?"right":"left";return o[v()]=T(),o}),N=t=>{const o=+s.min,v=+s.max,b=+s.step;t=He(t,o,v);const f=Math.round((t-o)/b)*b;return Ee(o,f)},F=()=>{const t=s.modelValue;p(t)?g=t.map(N):g=N(t)},B=t=>{var o,v;const b=(o=t[0])!=null?o:Number(s.min),f=(v=t[1])!=null?v:Number(s.max);return b>f?[f,b]:[b,f]},k=(t,o)=>{p(t)?t=B(t).map(N):t=N(t),me(t,s.modelValue)||m("update:modelValue",t),o&&!me(t,g)&&m("change",t)},M=t=>{if(t.stopPropagation(),s.disabled||s.readonly)return;F();const{min:o,reverse:v,vertical:b,modelValue:f}=s,x=fe(S),ee=()=>b?v?x.bottom-t.clientY:t.clientY-x.top:v?x.right-t.clientX:t.clientX-x.left,te=b?x.height:x.width,L=Number(o)+ee()/te*y.value;if(p(f)){const[H,Y]=f,ne=(H+Y)/2;L<=ne?k([L,Y],!0):k([H,L],!0)}else k(L,!0)},O=t=>{s.disabled||s.readonly||(C.start(t),a=s.modelValue,F(),h.value="start")},Q=t=>{if(s.disabled||s.readonly)return;h.value==="start"&&m("dragStart",t),ze(t,!0),C.move(t),h.value="dragging";const o=fe(S),v=s.vertical?C.deltaY.value:C.deltaX.value,b=s.vertical?o.height:o.width;let f=v/b*y.value;if(s.reverse&&(f=-f),p(g)){const x=s.reverse?1-l:l;a[x]=g[x]+f}else a=g+f;k(a)},z=t=>{s.disabled||s.readonly||(h.value==="dragging"&&(k(a,!0),m("dragEnd",t)),h.value="")},Z=t=>typeof t=="number"?X("button-wrapper",["left","right"][t]):X("button-wrapper",s.reverse?"left":"right"),J=(t,o)=>{const v=h.value==="dragging";if(typeof o=="number"){const b=P[o===0?"left-button":"right-button"];let f;if(v&&Array.isArray(a)&&(f=a[0]>a[1]?l^1:l),b)return b({value:t,dragging:v,dragIndex:f})}return P.button?P.button({value:t,dragging:v}):u("div",{class:X("button"),style:Oe(s.buttonSize)},null)},D=t=>{const o=typeof t=="number"?s.modelValue[t]:s.modelValue;return u("div",{ref:V[t??0],role:"slider",class:Z(t),tabindex:s.disabled?void 0:0,"aria-valuemin":s.min,"aria-valuenow":o,"aria-valuemax":s.max,"aria-disabled":s.disabled||void 0,"aria-readonly":s.readonly||void 0,"aria-orientation":s.vertical?"vertical":"horizontal",onTouchstartPassive:v=>{typeof t=="number"&&(l=t),O(v)},onTouchend:z,onTouchcancel:z,onClick:De},[J(o,t)])};return k(s.modelValue),Fe(()=>s.modelValue),V.forEach(t=>{Me("touchmove",Q,{target:t})}),()=>u("div",{ref:S,style:i.value,class:X({vertical:s.vertical,disabled:s.disabled}),onClick:M},[u("div",{class:X("bar"),style:A.value},[s.range?[D(0),D(1)]:D()])])}});const rt=_e(it),ut=""+new URL("../icons/vinyl.png",import.meta.url).href,ct=""+new URL("../icons/needle.png",import.meta.url).href,dt=""+new URL("../icons/audio.svg",import.meta.url).href,vt=""+new URL("../icons/clock.svg",import.meta.url).href,pe=""+new URL("../icons/cart.svg",import.meta.url).href,mt=""+new URL("../icons/Table.svg",import.meta.url).href,ft=""+new URL("../icons/Previous.svg",import.meta.url).href,gt=""+new URL("../icons/Next.svg",import.meta.url).href,pt=""+new URL("../icons/list.svg",import.meta.url).href,bt={key:0,class:"audio-player"},ht={class:"header"},_t={class:"title"},yt={class:"disc-wrapper"},kt=["src"],wt={class:"author"},Ct={class:"views-chip"},xt={class:"bottom-section"},Pt={class:"actions"},St=["src"],Vt=["src"],Tt={class:"progress"},At={class:"time-row"},Nt={class:"controls"},It=["src"],Ut=["src"],Bt={class:"playlist-sheet"},Lt={class:"playlist-header"},Rt=["src"],$t=["onClick"],Ft={class:"left"},Mt={class:"name"},zt={class:"popup-box"},Et={class:"popup-actions"},Ot={class:"purchase-sheet"},Dt={class:"row"},Ht={class:"row"},Kt={class:"red"},Xt={class:"notice"},Yt={class:"row"},jt={class:"red"},Wt=["src"],qt={key:1,class:"empty-data-message"},Gt=ie({__name:"AudioPlayer",setup(s){const m=Ke(),P=Xe();E(()=>P.params.id);const l=d(null),a=d(null),g=d(!1),S=d(!1),V=d(0),h=d(0),C=d(!1),y=d(!1),i=d(0),p=d(1),U=E(()=>l.value?Number((l.value.coinPrice*p.value).toFixed(2)):0),T=d(!0),A=d(!1),N=d(Object.values(ge)),F=E(()=>T.value?[...N.value]:[...N.value].reverse()),B=d(!1),k=d(!1),M=d(!1),O=d(!1),Q=[{name:"不启用"},{name:"播放完当前声音"},{name:"10分钟"},{name:"20分钟"},{name:"30分钟"},{name:"40分钟"},{name:"60分钟"}];let z=null;function Z(){T.value=!T.value}function J(r){if(z&&clearTimeout(z),r.name==="不启用")I("定时关闭已取消");else if(r.name==="播放完当前声音")I("将在当前音频结束后关闭"),a.value?.addEventListener("ended",D,{once:!0});else{const n=parseInt(r.name);if(!isNaN(n)){const K=n*60*1e3;z=setTimeout(()=>{a.value?.pause(),I("已自动停止播放")},K),I(`将在 ${n} 分钟后关闭`)}}}function D(){a.value?.pause(),I("已自动停止播放")}function t(){C.value=!C.value,I(C.value?"点赞成功":"取消点赞")}function o(){y.value=!y.value,I(y.value?"收藏成功":"取消收藏")}function v(){l.value?.type==="coin"?k.value=!0:O.value=!0}function b(){l.value&&i.value>=U.value?(i.value-=U.value,k.value=!1,I("购买成功并解锁")):(k.value=!1,M.value=!0)}function f(){a.value&&(g.value?a.value.pause():a.value.play(),g.value=!g.value)}function x(){a.value&&(S.value=!S.value,a.value.muted=S.value)}function ee(){a.value&&(V.value=Math.floor(a.value.currentTime),h.value=Math.floor(a.value.duration))}function te(r){a.value&&(a.value.currentTime=r)}function L(r){const n=Math.floor(r/60),K=Math.floor(r%60).toString().padStart(2,"0");return`${n}:${K}`}function H(r){return r>=1e4?(r/1e4).toFixed(1)+"w":r.toString()}function Y(r){return r>=1e4?(r/1e4).toFixed(2)+"w":r>=1e3?(r/1e3).toFixed(2)+"k":r.toString()}function ne(){window.history.back()}function re(){m.push("/promotion-share")}function ue(){m.push("/vip")}function ce(){m.push("/vip?tab=coin")}function ye(){a.value&&(a.value.currentTime=0)}function ke(){a.value&&(a.value.currentTime=h.value)}function we(){a.value&&(h.value=Math.floor(a.value.duration))}function Ce(r){l.value=r,a.value&&(a.value.src=r.audioUrl,V.value=0,g.value=!1),A.value=!1}return Ye(()=>P.params.id,r=>{r&&typeof r=="string"?l.value=ge[r]:l.value=null},{immediate:!0}),(r,n)=>{const K=rt,se=at,xe=le,de=he,ae=Ze;return l.value?(q(),W("div",bt,[e("div",ht,[e("img",{src:Ge,class:"header-icon",onClick:ne}),e("span",_t,_(l.value.title),1),e("img",{src:Qe,class:"header-icon",onClick:re})]),e("div",yt,[e("div",{class:G(["disc",{spinning:g.value}])},[n[11]||(n[11]=e("img",{class:"record",src:ut,alt:"唱片"},null,-1)),e("img",{class:"cover",src:l.value.cover,alt:"封面"},null,8,kt)],2),e("img",{src:ct,class:G(["needle",{active:g.value}])},null,2)]),e("div",wt,[R(" 作者："+_(l.value.author)+" ",1),e("span",Ct,[n[12]||(n[12]=e("img",{src:dt,class:"audio-icon"},null,-1)),R(" "+_(H(l.value.views)),1)])]),e("div",xt,[e("div",Pt,[e("div",{onClick:t},[e("img",{src:C.value?"/icons/like7.svg":"/icons/like6.svg",class:"big-icon"},null,8,St),e("span",null,_(H(l.value.views)),1)]),e("div",{onClick:o},[e("img",{src:y.value?"/icons/star7.svg":"/icons/star6.svg",class:"big-icon"},null,8,Vt),e("span",null,_(Y(l.value.favorites)),1)]),e("div",{onClick:n[0]||(n[0]=c=>B.value=!0)},n[13]||(n[13]=[e("img",{src:vt},null,-1),e("span",null,"定时",-1)])),e("div",{onClick:v},[n[14]||(n[14]=e("img",{src:pe},null,-1)),e("span",null,_(l.value.type==="vip"?"开通VIP":"单章购买"),1)])]),e("div",Tt,[u(K,{modelValue:V.value,"onUpdate:modelValue":n[1]||(n[1]=c=>V.value=c),max:h.value,onChange:te,"bar-height":"2px","button-size":"14px"},null,8,["modelValue","max"])]),e("div",At,[e("span",null,_(L(V.value)),1),e("span",null,_(L(h.value)),1)]),e("div",Nt,[e("img",{src:mt,onClick:n[2]||(n[2]=c=>A.value=!0)}),e("img",{src:ft,onClick:ye}),e("img",{src:g.value?"/icons/pause5.svg":"/icons/play5.svg",class:"play-icon",onClick:f},null,8,It),e("img",{src:gt,onClick:ke}),e("img",{src:S.value?"/icons/mute.svg":"/icons/sound.svg",onClick:x},null,8,Ut)])]),u(se,{show:B.value,"onUpdate:show":n[3]||(n[3]=c=>B.value=c),title:"定时关闭",actions:Q,onSelect:J,"close-on-click-action":"",closeable:""},null,8,["show"]),u(se,{show:A.value,"onUpdate:show":n[5]||(n[5]=c=>A.value=c),closeable:"","close-on-click-overlay":"","safe-area-inset-bottom":""},{default:$(()=>[e("div",Bt,[e("div",Lt,[e("div",{class:"sort",onClick:Z},[e("img",{src:T.value?"/icons/sort-asc.svg":"/icons/sort-desc.svg",class:"sort-icon"},null,8,Rt),e("span",null,_(T.value?"正序":"倒序"),1)]),n[15]||(n[15]=e("div",{class:"title-center"},"播放列表",-1)),u(xe,{name:"cross",size:"20",onClick:n[4]||(n[4]=c=>A.value=!1)})]),(q(!0),W(je,null,We(F.value,c=>(q(),W("div",{key:c.id,class:"playlist-item",onClick:Qt=>Ce(c)},[e("div",Ft,[n[16]||(n[16]=e("img",{src:pt,class:"list-icon"},null,-1)),e("span",Mt,_(c.title),1),e("span",{class:G(["badge",c.type==="coin"?"coin":"vip"])},_(c.type==="coin"?"金币":"VIP"),3)]),e("div",{class:"right",onClick:qe(v,["stop"])},n[17]||(n[17]=[e("img",{src:pe},null,-1),e("span",null,"购买",-1)]))],8,$t))),128))])]),_:1},8,["show"]),u(de,{show:M.value,"onUpdate:show":n[7]||(n[7]=c=>M.value=c),"close-on-click-overlay":"",style:{maxWidth:"90%",width:"500px",borderRadius:"12px"}},{default:$(()=>[e("div",zt,[n[18]||(n[18]=e("h3",null,"温馨提示",-1)),n[19]||(n[19]=e("p",{class:"popup-text"},"金币余额不足，是否立即充值",-1)),e("div",Et,[e("button",{class:"gray-btn",onClick:n[6]||(n[6]=c=>M.value=!1)},"取消"),e("button",{class:"orange-btn",onClick:ce},"立即充值")])])]),_:1},8,["show"]),u(de,{show:O.value,"onUpdate:show":n[8]||(n[8]=c=>O.value=c),"close-on-click-overlay":"",style:{maxWidth:"90%",width:"500px",borderRadius:"12px"}},{default:$(()=>[e("div",{class:"popup-box"},[n[20]||(n[20]=e("h3",null,"温馨提示",-1)),n[21]||(n[21]=e("p",{class:"popup-text"},[R(" 有声免费解锁次数已用完，开通VIP可畅享免费解锁"),e("br"),R("邀请好友注册立刻送3天VIP ")],-1)),e("div",{class:"popup-actions"},[e("button",{class:"gray-btn",onClick:re},"分享得VIP"),e("button",{class:"orange-btn",onClick:ue},"立即开通VIP")])])]),_:1},8,["show"]),u(se,{show:k.value,"onUpdate:show":n[9]||(n[9]=c=>k.value=c),closeable:"","safe-area-inset-bottom":""},{default:$(()=>[e("div",Ot,[n[27]||(n[27]=e("h3",null,"购买单章金币有声",-1)),e("div",Dt,[e("div",null,"金币余额："+_(i.value.toFixed(2)),1),u(ae,{type:"default",plain:"",size:"small",onClick:ce,style:{"border-color":"#333",color:"#333","font-size":"13px","border-radius":"6px",padding:"0 8px"}},{default:$(()=>n[22]||(n[22]=[R(" 立即充值 ")])),_:1,__:[22]})]),e("div",Ht,[n[23]||(n[23]=e("span",null,"支付金额",-1)),e("span",Kt,_(l.value.coinPrice.toFixed(2))+"金币",1)]),e("div",Xt,[e("span",{class:G({orange:p.value>=1,red:p.value<1})},_(p.value<1?`您享受 ${(p.value*10).toFixed(1)}折优惠`:"您当前不享受折扣优惠"),3),u(ae,{type:"primary",plain:"",size:"small",color:"#ff69b4",onClick:ue},{default:$(()=>n[24]||(n[24]=[R(" 购买VIP享受折扣 ")])),_:1,__:[24]})]),n[28]||(n[28]=e("div",{class:"divider"},null,-1)),e("div",Yt,[n[25]||(n[25]=e("span",null,"实际支付",-1)),e("span",jt,_(U.value.toFixed(2))+"金币",1)]),u(ae,{type:"primary",block:"",color:"#f60",class:"buy-btn",onClick:b},{default:$(()=>n[26]||(n[26]=[R(" 立即购买 ")])),_:1,__:[26]})])]),_:1},8,["show"]),e("audio",{ref_key:"audio",ref:a,src:l.value.audioUrl,onLoadedmetadata:we,onTimeupdate:ee,onEnded:n[10]||(n[10]=c=>g.value=!1)},null,40,Wt)])):(q(),W("div",qt," 找不到音频数据~ "))}}}),on=Je(Gt,[["__scopeId","data-v-703b761c"]]);export{on as default};
