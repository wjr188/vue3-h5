import{_ as ie}from"./back-DXvGtdGP.js";import{d as O,u as N,q as U,s as W,c as f,a as i,b as e,v as M,x as ce,t as g,f as ne,y as H,r as d,o as G,k as K,m as z,F as P,e as D,l as j,i as q,j as R,p as h,z as A,A as le,h as F,K as ue,B as ve,S as de}from"./index-CKjozqaQ.js";import{_ as _e}from"./dynamic-import-helper-BheWnx7M.js";import{a as J,S as Q}from"./swiper.min-DhCtGxFp.js";import{_ as me}from"./play4-3PhygbDH.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{N as pe,_ as ke,V as ge}from"./VideoProgress-CsCbmb85.js";import{u as fe}from"./useHistoryStore-DEf3NF2P.js";import{T as ye}from"./TabBar-BmLwAtYY.js";import"./hls-AJDOUA6Y.js";import"./function-call-Cn_FLeOo.js";import"./index-BvDqeyKw.js";const he=""+new URL("../icons/search.svg",import.meta.url).href,we={class:"cover-wrapper"},Te={class:"cover"},be={class:"info-bar"},Ce={class:"views"},$e={class:"duration"},Se={class:"title"},Ee=O({__name:"VideoCardTiktok",props:{index:{},category:{},title:{},cover:{},views:{},duration:{},tag:{},tags:{},tagColor:{}},setup(x){const a=N(),u=x,r=U(()=>u.tags?.[0]||u.tag||""),v=()=>{a.push({path:"/play-tiktok",query:{category:u.category,index:u.index,from:"discover"}})};return(m,l)=>{const y=W("lazy");return i(),f("div",{class:"video-card",onClick:v},[e("div",we,[M(e("img",Te,null,512),[[y,m.cover]]),e("div",be,[e("div",Ce,[l[0]||(l[0]=e("img",{src:me,class:"play-icon",alt:"播放"},null,-1)),ce(" "+g(m.views),1)]),e("div",$e,g(m.duration),1)])]),e("div",Se,g(m.title),1),e("div",{class:"tag",style:ne({background:m.tagColor})},g(r.value),5)])}}}),Re=B(Ee,[["__scopeId","data-v-2872cf59"]]),Ie={class:"discover-wrapper"},Ve={class:"category-bar",ref:"navBar"},Pe={class:"category-list",ref:"scrollWrap"},De=["onClick"],je={class:"video-grid"},qe=O({__name:"TiktokDiscover",setup(x){const a=H(),u=N(),r=d("最新"),v=["最新","最热","巨乳","美臀","学生","女儿","乱伦","白虎","内射","调教","网黄"],m=d(null);let l=null;const y=d({}),_={最新:"zui_xin",最热:"zui_re",巨乳:"ju_ru",美臀:"mei_tun",学生:"xue_sheng",女儿:"nv_er",乱伦:"luan_lun",白虎:"bai_hu",内射:"nei_she",调教:"tiao_jiao",网黄:"wang_huang"},c=async o=>{if(y.value[o])return;const s=_[o];try{const n=await _e(Object.assign({"../mock/tiktok/bai_hu.js":()=>h(()=>import("./bai_hu-BU1IN_nu.js"),[],import.meta.url),"../mock/tiktok/ju_ru.js":()=>h(()=>import("./ju_ru-DX9ZIAEN.js"),[],import.meta.url),"../mock/tiktok/luan_lun.js":()=>h(()=>import("./luan_lun-DX9ZIAEN.js"),[],import.meta.url),"../mock/tiktok/mei_tun.js":()=>h(()=>import("./mei_tun-DX9ZIAEN.js"),[],import.meta.url),"../mock/tiktok/nei_she.js":()=>h(()=>import("./nei_she-DX9ZIAEN.js"),[],import.meta.url),"../mock/tiktok/nv_er.js":()=>h(()=>import("./nv_er-DX9ZIAEN.js"),[],import.meta.url),"../mock/tiktok/tiao_jiao.js":()=>h(()=>import("./tiao_jiao-DX9ZIAEN.js"),[],import.meta.url),"../mock/tiktok/wang_huang.js":()=>h(()=>import("./wang_huang-DX9ZIAEN.js"),[],import.meta.url),"../mock/tiktok/xue_sheng.js":()=>h(()=>import("./xue_sheng-DX9ZIAEN.js"),[],import.meta.url),"../mock/tiktok/zui_re.js":()=>h(()=>import("./zui_re-C336kuBn.js"),[],import.meta.url),"../mock/tiktok/zui_xin.js":()=>h(()=>import("./zui_xin-DSCovyGQ.js"),[],import.meta.url)}),`../mock/tiktok/${s}.js`,4);y.value[o]=n.default}catch(n){console.error(`加载失败: ${s}.js`,n),y.value[o]=[]}},b=async(o,s)=>{r.value=s,u.replace({query:{...a.query,category:s}}),await c(s),l&&l.slideTo?l.slideTo(o):console.error("Swiper 实例未初始化")},E=async o=>{const s=v[o.activeIndex];r.value=s,u.replace({query:{...a.query,category:s}}),await c(s),$(o.activeIndex)},I=o=>{l=o},$=o=>{const s=document.querySelectorAll(".category-item")[o],n=document.querySelector(".category-bar");if(s&&n){const S=s.offsetLeft-n.offsetWidth/2+s.offsetWidth/2;n.scrollTo({left:S,behavior:"smooth"})}};return G(async()=>{const o=a.query.category;if(o&&v.includes(o)){r.value=o,await c(o);const s=v.indexOf(o);l&&l.slideTo(s),$(s)}else await c(r.value)}),K(()=>a.query.category,async o=>{if(typeof o=="string"&&v.includes(o)){r.value=o;const s=v.indexOf(o);await c(o),l&&l.slideTo(s),$(s)}}),(o,s)=>(i(),f("div",Ie,[e("div",Ve,[e("div",Pe,[(i(),f(P,null,D(v,(n,S)=>e("div",{class:A(["category-item",{active:r.value===n}]),key:S,onClick:w=>b(S,n)},g(n),11,De)),64))],512)],512),z(q(Q),{ref_key:"swiperRef",ref:m,class:"discover-swiper","slides-per-view":1,"resistance-ratio":.3,threshold:20,speed:300,"space-between":0,onSlideChange:E,onSwiper:I},{default:j(()=>[(i(),f(P,null,D(v,(n,S)=>z(q(J),{key:n},{default:j(()=>[e("div",je,[(i(!0),f(P,null,D(y.value[n]||[],(w,L)=>(i(),R(Re,{key:L,index:L,category:n,cover:w.cover,views:String(w.views),duration:w.duration,title:w.title,tag:w.tag,tags:w.tags,tagColor:w.tagColor},null,8,["index","category","cover","views","duration","title","tag","tags","tagColor"]))),128))])]),_:2},1024)),64))]),_:1},512)]))}}),xe=B(qe,[["__scopeId","data-v-f293a59c"]]),Le={class:"tiktok-wrapper"},ze={class:"swiper-area"},Ae={class:"video-page"},Oe={key:1,class:"preview-cover"},Ne={class:"video-overlay"},Be={class:"author"},Fe={class:"name"},Me={class:"title"},Ke={class:"tags"},Ue={class:"unlock"},We={class:"video-actions"},He={class:"avatar"},Ge=["onClick"],Je=["src"],Qe={class:"count"},Xe=["onClick"],Ye=["src"],Ze={class:"count"},et=O({__name:"TiktokRecommend",setup(x){const a=d(0),u=d(!1),r=d([]),v=d({}),m=N(),l=d(0),y=d(0),_=fe();let c=1;const b=d({}),E=d({}),I=d(""),$=d(!1);function o(t,p=!1){let T=typeof t=="string"?Number(t.toString().replace(/[^\d.]/g,"")):t;return isNaN(T)&&(T=0),T>=1e4?(T/1e4).toFixed(2)+"w":T>=1e3?(T/1e3).toFixed(2)+"k":T}let s=null;function n(t,p=1500){I.value=t,$.value=!0,s&&clearTimeout(s),s=setTimeout(()=>{$.value=!1,setTimeout(()=>{I.value=""},300)},p)}const S=()=>{const t=[{src:`https://zh.977700.com/${c*2-1}/index.m3u8`,cover:`https://zh.977700.com/${c*2-1}/cover.webp`,author:"甜妹爱自拍",title:"小骚妹自慰诱惑，呜呜 啪啪不停！",tags:["少女","粉嫩","自慰"],duration:"18:47",avatar:"/images/666.webp",likes:"53000",favorites:"3473"},{src:`https://zh.977700.com/${c*2}/index.m3u8`,cover:`https://zh.977700.com/${c*2}/cover.webp`,author:"爆乳小野猫",title:"顶到花心了！不要停～",tags:["巨乳","激情","呻吟"],duration:"12:30",avatar:"/images/666.webp",likes:"31000",favorites:"2201"}];r.value.push(...t),c++},w=t=>{a.value=t.activeIndex,u.value=!1,a.value>=r.value.length-2&&S()},L=t=>{},X=()=>{u.value=!0},Y=t=>{l.value=t.currentTime,y.value=t.duration},Z=t=>{l.value=t},ee=()=>{const t=r.value[a.value];t&&_.addRecord({id:t.src,type:"douyin",time:new Date().toISOString(),data:t})},te=t=>{const p=v.value[a.value];p?.seekTo&&(p.seekTo(t),u.value=!0)},oe=(t,p)=>{v.value[t]=p},se=()=>{m.push("/promotion-share")};function ae(t){b.value[t]=!b.value[t],n(b.value[t]?"点赞成功":"取消点赞")}function re(t){E.value[t]=!E.value[t],n(E.value[t]?"收藏成功":"取消收藏")}return G(()=>{S(),document.body.style.overflow="hidden"}),le(()=>{document.body.style.overflow=""}),(t,p)=>{const T=W("lazy");return i(),f("div",Le,[e("div",ze,[z(q(Q),{direction:"vertical","slides-per-view":1,"space-between":0,"resistance-ratio":.35,threshold:20,observer:!0,"observe-parents":!0,class:"tiktok-container",onSlideChange:w,onSwiper:L},{default:j(()=>[(i(!0),f(P,null,D(r.value,(k,C)=>(i(),R(q(J),{key:k.src},{default:j(()=>[e("div",Ae,[C===a.value?(i(),R(pe,{ref_for:!0,ref:V=>oe(C,V),key:k.src,src:k.src,cover:k.cover,shouldPlay:u.value,onRequestPlay:X,onTimeUpdate:Y,onPlayed:ee},null,8,["src","cover","shouldPlay"])):Math.abs(C-a.value)===1?M((i(),f("img",Oe,null,512)),[[T,k.cover]]):F("",!0)]),e("div",Ne,[e("div",Be,[e("span",Fe,"@"+g(k.author),1),p[0]||(p[0]=e("span",{class:"verified-badge"},"V",-1))]),e("div",Me,g(k.title),1),e("div",Ke,[(i(!0),f(P,null,D(k.tags,V=>(i(),f("span",{class:"tag",key:V},"#"+g(V),1))),128))]),e("div",Ue,"开通VIP观看完整视频 "+g(k.duration),1)]),e("div",We,[M(e("img",He,null,512),[[T,k.avatar]]),e("div",{class:"action-item",onClick:V=>ae(C)},[e("img",{src:b.value[C]?"/icons/like7.svg":"/icons/like.svg",class:"action-icon"},null,8,Je),e("div",Qe,g(o(k.likes,b.value[C])),1)],8,Ge),e("div",{class:"action-item",onClick:V=>re(C)},[e("img",{src:E.value[C]?"/icons/star7.svg":"/icons/fav1.svg",class:"action-icon"},null,8,Ye),e("div",Ze,g(o(k.favorites,E.value[C])),1)],8,Xe),e("div",{class:"action-item",onClick:se},p[1]||(p[1]=[e("img",{src:ke,class:"action-icon"},null,-1),e("div",{class:"count"},"分享",-1)]))])]),_:2},1024))),128))]),_:1})]),r.value[a.value]?(i(),R(ge,{key:0,currentTime:Number(l.value),duration:Number(y.value),onSeek:te,onSeeking:Z,class:"video-progress-fixed"},null,8,["currentTime","duration"])):F("",!0),$.value||I.value?(i(),f("div",{key:1,class:A(["toast-tip",{show:$.value}])},g(I.value),3)):F("",!0)])}}}),tt=B(et,[["__scopeId","data-v-82d21bcb"]]),ot={class:"tiktok-page"},st={class:"top-bar"},at={class:"tab-group"},rt={class:"page-content"},it=O({__name:"Tiktok",setup(x){const a=H(),u=N(),r=d(a.query.tab==="discover"?"discover":"recommend"),v=d(a.query.category||"最新");K(()=>a.query.tab,_=>{(_==="discover"||_==="recommend")&&(r.value=_)}),K(()=>a.query.category,_=>{typeof _=="string"&&(v.value=_)});function m(_){_!==r.value&&u.replace({path:"/tiktokIndex",query:{tab:_,category:v.value}})}function l(){a.query.from==="discover"?u.push({path:"/tiktokIndex",query:{tab:"discover",category:v.value}}):u.back()}const y=U(()=>r.value==="discover"?xe:tt);return(_,c)=>(i(),f("div",ot,[e("div",st,[e("img",{src:ie,class:"top-icon back",onClick:l}),e("div",at,[e("span",{class:A(["tab-item",r.value==="discover"?"active":""]),onClick:c[0]||(c[0]=b=>m("discover"))},"发现",2),e("span",{class:A(["tab-item",r.value==="recommend"?"active":""]),onClick:c[1]||(c[1]=b=>m("recommend"))},"推荐",2)]),c[2]||(c[2]=e("img",{src:he,class:"top-icon search"},null,-1))]),e("div",rt,[(i(),R(de,null,{default:j(()=>[(i(),R(ue,null,[(i(),R(ve(y.value),{category:q(a).query.category||"最新"},null,8,["category"]))],1024))]),_:1}))]),z(ye)]))}}),yt=B(it,[["__scopeId","data-v-1b8ba7fd"]]);export{yt as default};
