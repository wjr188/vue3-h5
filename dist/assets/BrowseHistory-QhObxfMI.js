import{d as L,u as U,o as V,r as S,q as I,c as l,a as c,m as y,l as h,b as s,t as r,at as z,F as g,e as x,av as A,z as j,j as O,h as B,a6 as Y,w as G,aw as J,ax as K,M as m}from"./index-CKjozqaQ.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{u as P}from"./useHistoryStore-DEf3NF2P.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"history-page"},X={key:0,class:"select-actions"},Z={class:"history-list"},ee=["onClick"],te={key:0,class:"video-card-row"},oe=["src"],ae={class:"video-text"},se={class:"video-title"},ne={class:"video-meta"},ce=["src"],le={class:"grid-title"},re={class:"grid-meta"},ie=["src"],de={class:"grid-title"},ue={class:"grid-meta"},ve={key:1,class:"empty-wrapper"},pe=L({__name:"BrowseHistory",setup(_e){const v=P(),u=U();V(()=>{v.loadFromLocal()});const p=S("video"),i=S(!1),a=S([]),M=()=>{i.value=!i.value,i.value||(a.value=[])},R=e=>{a.value.includes(e)?a.value=a.value.filter(t=>t!==e):a.value.push(e)},_=I(()=>{const e={video:[],douyin:[],only_video:[],only_img:[],comic:[],novel:[],audio:[]};for(const t of v.records)e[t.type]&&e[t.type].push(t);return e}),w=I(()=>{const e=_.value[p.value]||[];return e.length>0&&a.value.length===e.length}),q=()=>{const t=(_.value[p.value]||[]).map(d=>d.id);w.value?a.value=[]:a.value=[...t]},D=()=>{if(a.value.length===0){m("请先选择要删除的记录");return}a.value.forEach(e=>{const t=v.records.find(d=>d.id===e);t&&v.removeRecord(t.id,t.type)}),a.value=[],m("已批量删除")},F=e=>{v.removeRecord(e.id,e.type),a.value=a.value.filter(t=>t!==e.id),m("已移除该记录")},H=[{label:"视频",key:"video"},{label:"抖阴",key:"douyin"},{label:"Only圈图片",key:"only_img"},{label:"漫画",key:"comic"},{label:"小说",key:"novel"},{label:"有声",key:"audio"}],N=e=>e==="video"?"history-card":"grid-card";function $(e){if(!e)return"";const t=new Date(e),d=t.getFullYear(),k=String(t.getMonth()+1).padStart(2,"0"),f=String(t.getDate()).padStart(2,"0"),b=String(t.getHours()).padStart(2,"0"),C=String(t.getMinutes()).padStart(2,"0"),n=String(t.getSeconds()).padStart(2,"0");return`${d}-${k}-${f} ${b}:${C}:${n}`}function T(e){switch(e.type){case"video":u.push({path:"/play",query:{src:encodeURIComponent(e.id),title:e.data?.title||"",cover:e.data?.cover||""}});break;case"douyin":u.push({path:"/play-tiktok",query:{index:"0",category:"最新"}});break;case"only_img":u.push({path:`/star-image-detail/${encodeURIComponent(e.id)}`});break;case"comic":u.push({path:`/comic/${e.id}`});break;case"novel":u.push({path:`/novel/${e.id}`});break;case"audio":u.push({path:"/audioDetail",query:{id:e.id}});break;default:m("不支持跳转")}}return(e,t)=>{const d=z,k=Y,f=J,b=A,C=K;return c(),l("div",W,[y(d,{title:"浏览记录","left-arrow":"",fixed:"","safe-area-inset-top":"",onClickLeft:t[0]||(t[0]=n=>e.$router.back())},{right:h(()=>[s("span",{class:"nav-btn",onClick:M},r(i.value?"完成":"管理"),1)]),_:1}),y(C,{active:p.value,"onUpdate:active":t[1]||(t[1]=n=>p.value=n),swipeable:"",sticky:"","offset-top":"46",background:"#f8f8f8","line-width":"20px",color:"#f14b4b"},{"nav-bottom":h(()=>[i.value?(c(),l("div",X,[s("span",{onClick:q},r(w.value?"取消全选":"全选"),1),s("span",{class:"delete-batch",onClick:D},"删除")])):B("",!0)]),default:h(()=>[(c(),l(g,null,x(H,n=>y(b,{title:n.label,key:n.key,name:n.key},{default:h(()=>[s("div",Z,[_.value[n.key]?.length?(c(!0),l(g,{key:0},x(_.value[n.key],o=>(c(),l("div",{key:o.id,class:j([N(o.type),{selected:a.value.includes(o.id)}]),onClick:E=>i.value?R(o.id):T(o)},[o.type==="video"?(c(),l("div",te,[s("img",{src:o.data?.cover,class:"video-thumb-row"},null,8,oe),s("div",ae,[s("div",se,r(o.data?.title||"无标题视频"),1),s("div",ne,"浏览时间："+r($(o.time)),1)])])):["comic","novel"].includes(o.type)?(c(),l(g,{key:1},[s("img",{src:o.data?.cover,class:"grid-thumb"},null,8,ce),s("div",le,r(o.data?.title||"无标题"),1),s("div",re," 共"+r(o.data?.episodes||0)+"话 · 上次看到第"+r(o.data?.lastRead||0)+"话 ",1)],64)):(c(),l(g,{key:2},[s("img",{src:o.data?.cover,class:"grid-thumb"},null,8,ie),s("div",de,r(o.data?.title||"无标题"),1),s("div",ue,"浏览时间："+r($(o.time)),1)],64)),i.value?(c(),O(k,{key:3,name:"cross",class:"delete-icon",onClick:G(E=>F(o),["stop"])},null,8,["onClick"])):B("",!0)],10,ee))),128)):(c(),l("div",ve,[y(f,{description:"暂无浏览记录",image:"/icons/empty.webp"})]))])]),_:2},1032,["title","name"])),64))]),_:1},8,["active"])])}}}),Se=Q(pe,[["__scopeId","data-v-43530961"]]);export{Se as default};
