import{d as D,r as c,q as V,o as R,k as E,s as $,v as C,I as j,a as p,c as v,w as z,b as a,f as B,z as P,t as h,F as A,e as L,p as f}from"./index-CKjozqaQ.js";import{_ as O}from"./dynamic-import-helper-BheWnx7M.js";import{_ as x}from"./back3-q87-H97k.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"header-bar"},q={class:"title"},H=["src"],G={class:"chapter-list"},J=["onClick"],K={class:"chapter-cover-new"},Q={class:"chapter-info"},U={class:"chapter-title"},W={class:"read-btn"},X=D({__name:"ChapterDrawer",props:{chapters:{},comicId:{},comicTitle:{},modelValue:{type:Boolean},fullScreen:{type:Boolean},type:{},cover:{}},emits:["close","update:modelValue","read-chapter-from-drawer"],setup(w,{emit:y}){const s=w,n=y,i=c(!0),I=()=>{i.value=!i.value},k=V(()=>{const e=[...s.chapters].sort((t,o)=>Number(t.id)-Number(o.id));return i.value?e:e.reverse()}),l=c(null),b=e=>{l.value=e,localStorage.setItem(`lastReadChapter_${s.comicId}`,e.toString()),n("read-chapter-from-drawer",e),_()},S=e=>{switch(e.status){case"free":return"免费";case"vip":return"VIP";case"coin":return`${e.price||0}金币`;default:return"观看"}},d=c(!1),m=c(!1);let u=null;const _=()=>{n("close"),n("update:modelValue",!1)},g=c({});async function N(e,t){if(s.type==="novel")return s.cover||"";try{const o=await O(Object.assign({"../mock/acg/comic/chapter/1_1.js":()=>f(()=>import("./1_1-DTCd7SiF.js"),[],import.meta.url),"../mock/acg/comic/chapter/1_2.js":()=>f(()=>import("./1_2-zZQJg1jI.js"),[],import.meta.url),"../mock/acg/comic/chapter/1_3.js":()=>f(()=>import("./1_3-DTCd7SiF.js"),[],import.meta.url)}),`../mock/acg/comic/chapter/${e}_${t}.js`,6);return o.default.images?.[4]||o.default.images?.[0]||""}catch{return""}}async function T(){const e={};for(const t of s.chapters)e[String(t.id)]=await N(s.comicId,t.id);g.value=e}return R(()=>{const e=Number(localStorage.getItem(`lastReadChapter_${s.comicId}`));isNaN(e)||(l.value=e)}),E(()=>s.modelValue,async e=>{if(e){await T();const t=Number(localStorage.getItem(`lastReadChapter_${s.comicId}`));isNaN(t)||(l.value=t),d.value=!0,u&&clearTimeout(u),setTimeout(()=>{m.value=!0},10)}else m.value=!1,u=setTimeout(()=>{d.value=!1},300)},{immediate:!0}),(e,t)=>{const o=$("lazy");return C((p(),v("div",{class:"drawer-overlay",onClick:z(_,["self"])},[a("div",{class:P(["drawer-wrapper",{active:m.value}]),style:B({width:e.fullScreen?"100%":"80%"})},[a("div",M,[a("img",{src:x,class:"back-icon",onClick:_}),a("div",q,h(e.comicTitle),1),a("img",{src:i.value?"/icons/sort-desc.svg":"/icons/sort-asc.svg",class:"sort-icon",onClick:I},null,8,H)]),a("div",G,[(p(!0),v(A,null,L(k.value,r=>(p(),v("div",{class:"chapter-item",key:r.id,onClick:Y=>b(Number(r.id))},[C(a("img",K,null,512),[[o,g.value[r.id]]]),a("div",Q,[a("div",U,h(r.title),1)]),a("button",W,h(l.value===r.id?"上次":S(r)),1)],8,J))),128))])],6)],512)),[[j,d.value]])}}}),se=F(X,[["__scopeId","data-v-2218a2df"]]);export{se as C};
