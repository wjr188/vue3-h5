import{_ as me}from"./1-fzo8JEYb.js";import{_ as _e}from"./10-CgmEdRt1.js";import{_ as de}from"./11-CabwFj8e.js";import{_ as ge}from"./2-CuUYKjVo.js";import{_ as pe}from"./3-CDSPaFCZ.js";import{_ as fe}from"./4-DpjjeBM5.js";import{_ as he}from"./5-BY--KaCV.js";import{_ as ye}from"./6-BUa2zK63.js";import{_ as ke}from"./7-6vga_5yu.js";import{_ as be}from"./8-0KauOiHy.js";import{_ as we}from"./9-laFEHVAn.js";import{_ as Ce}from"./1-V7LAkzHJ.js";import{_ as Se,d as je,e as Ie,f as Te,g as Le,h as xe,i as De,j as Me,b as Ne,n as Ae,a as Oe,c as $e}from"./audioSubCategories-DGz5Be0W.js";import{_ as Ke}from"./audiodetail-COETxsht.js";import{d as Re,y as Ve,u as qe,r as u,q as J,k as U,n as A,o as ze,c as o,a as i,b as a,h,z as w,t as y,F as d,v as Be,D as He,m as P,i as g,x as E,e as I}from"./index-CKjozqaQ.js";import{_ as Je}from"./back3-q87-H97k.js";import{_ as Ue}from"./eye-CZ8VU-fn.js";import{_ as F}from"./loading-DSJ59oo9.js";import{A as W}from"./AcgSection-Cuw1vH7V.js";import{u as Y}from"./useLazyLoad-CfEeBfCV.js";import{_ as Pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AcgCard-BM0gqaW9.js";import"./play4-3PhygbDH.js";import"./swiper.min-DhCtGxFp.js";const Ee=""+new URL("../icons/empty.webp",import.meta.url).href,Fe=""+new URL("../icons/delete.svg",import.meta.url).href,We=""+new URL("../icons/hot1.svg",import.meta.url).href,Ye={漫画:["原神","火影","全彩","碧蓝航线","七龙珠","调教","萝莉控","英雄联盟","巨乳","ai绘画"],动漫:["海贼王","鬼灭之刃","JOJO","EVA","高达","钢炼","美少女战士","天降之物","CLANNAD","轻音少女"],小说:["霸道总裁","穿越重生","仙侠","都市言情","黑道","修真","宫斗","科幻","同人","灵异玄幻"],有声:["助眠","asmr","言情剧","推理悬疑","二次元","恐怖故事","爽文","甜宠","重生","古风"]},Ge={class:"search-main-page"},Qe={class:"top-bar"},Xe={class:"tabs"},Ze={class:"search-bar"},es={class:"search-input"},ss={key:0},ts={key:0,class:"loading-tip"},as={key:1,class:"no-more-text"},os={key:0,class:"history-wrapper"},is={class:"history-tags"},ls=["onClick"],rs={class:"hot-tags-wrapper"},cs={class:"hot-tags-box"},ns={class:"tag-list"},us=["onClick"],vs={class:"tag-text"},ms={class:"filter-wrapper"},_s={class:"filter-row"},ds={class:"filter-tags"},gs=["onClick"],ps={class:"filter-row"},fs={class:"filter-tags"},hs=["onClick"],ys={class:"filter-row"},ks={class:"filter-tags"},bs=["onClick"],ws={key:0,class:"loading-tip"},Cs={key:1,class:"no-more-text"},Ss=Re({__name:"SearchMainPage",setup(js){const G=Ve(),k=qe(),n=u(G.query.activeTab||"漫画"),p=u("search"),v=u(""),b=u(!1),f=u([]),M=J(()=>`searchHistory_${n.value}`),_=u([]);U(()=>M.value,e=>{_.value=JSON.parse(localStorage.getItem(e)||"[]")},{immediate:!0});const Q=e=>{v.value=e,T()},O={漫画:"漫画",动漫:"动漫",小说:"小说",有声:"有声"},$=e=>{p.value=e,e==="search"&&!v.value&&(b.value=!1,f.value=[])},T=()=>{v.value.trim()&&(b.value=!0,_.value.includes(v.value)||(_.value.unshift(v.value),_.value.length>10&&_.value.pop(),localStorage.setItem(M.value,JSON.stringify(_.value))),f.value=D.value.filter(e=>e.title.includes(v.value)||e.tag&&e.tag.some(s=>s.includes(v.value))))},X=()=>{_.value=[],localStorage.removeItem(M.value)},Z=()=>{v.value||(b.value=!1,f.value=[])},ee=e=>{v.value=e,T()},K={漫画:$e,动漫:Oe,小说:Ae,有声:Ne},R=e=>{const s=K[e]||[];return[{label:"全部分类",key:"全部分类"},...s]},L=u(R(n.value)),se=u(["全部标签","老师","辣妹","巨乳","欲望","本子"]),te=u(["综合排序","观看最多","最新上架","收藏最多"]),C=u(L.value[0]),S=u("全部标签"),x=u("综合排序");U(()=>n.value,async e=>{L.value=R(e),C.value=L.value[0],S.value="全部标签",x.value="综合排序",v.value="",b.value=!1,f.value=[],await N(e,!1)});const D=u([]);function V(e,s){const l=(K[s]||[]).find(m=>m.label===e);return l?l.key:""}const N=async(e,s=!1)=>{let t={};const l=[];try{e==="漫画"?t=Object.assign({"/src/mock/acg/comic/detail/1.js":me,"/src/mock/acg/comic/detail/10.js":_e,"/src/mock/acg/comic/detail/11.js":de,"/src/mock/acg/comic/detail/2.js":ge,"/src/mock/acg/comic/detail/3.js":pe,"/src/mock/acg/comic/detail/4.js":fe,"/src/mock/acg/comic/detail/5.js":he,"/src/mock/acg/comic/detail/6.js":ye,"/src/mock/acg/comic/detail/7.js":ke,"/src/mock/acg/comic/detail/8.js":be,"/src/mock/acg/comic/detail/9.js":we}):e==="小说"?t=Object.assign({"/src/mock/acg/novel/detail/1.js":Ce}):e==="动漫"?t=Object.assign({"/src/mock/acg/anime/1.js":Me,"/src/mock/acg/anime/2.js":De,"/src/mock/acg/anime/3.js":xe,"/src/mock/acg/anime/4.js":Le,"/src/mock/acg/anime/5.js":Te,"/src/mock/acg/anime/6.js":Ie,"/src/mock/acg/anime/8.js":je,"/src/mock/acg/anime/9.js":Se}):e==="有声"&&(t=Object.assign({"/src/mock/acg/audio/audiodetail.js":Ke}));for(const m in t){const H=t[m],r=H.default;if(e==="有声"&&!r){const c=H;if(c&&c.audiodetails){const ve=Object.values(c.audiodetails);for(const j of ve)l.push({id:j.id,title:j.title,cover:j.cover,tag:[],category:"有声",categoryKey:"all",views:j.views||0,fav:j.favorites||0,time:Date.now(),episodeCount:1})}continue}if(Array.isArray(r))for(const c of r)l.push({id:c?.id??"",title:c?.title??"",cover:c?.cover??"",tag:c?.tags||[],category:c?.category??"",categoryKey:V(c?.category,e),views:c?.views||0,fav:c?.likes||0,time:c?.time||Date.now(),episodeCount:c?.chapters?.length||0});else r&&l.push({id:r?.id??"",title:r?.title??"",cover:r?.cover??"",tag:r?.tags||[],category:r?.category??"",categoryKey:V(r?.category,e),views:r?.views||0,fav:r?.likes||0,time:r?.time||Date.now(),episodeCount:r?.chapters?.length||0})}D.value=l}catch(m){console.error(`[SearchMainPage] 加载数据失败 for category ${e}:`,m),D.value=[]}finally{if(b.value=!1,f.value=[],s){const m=sessionStorage.getItem("search-main-scroll-top");m&&(await A(),window.scrollTo(0,parseInt(m,10)),sessionStorage.removeItem("search-main-return-tab"),sessionStorage.removeItem("search-main-scroll-top"))}}},ae=J(()=>{let e=[...D.value];switch(C.value.key!=="全部分类"&&(e=e.filter(s=>s.categoryKey===C.value.key)),S.value!=="全部标签"&&(e=e.filter(s=>s.tag.includes(S.value))),x.value){case"观看最多":e.sort((s,t)=>t.views-s.views);break;case"最新上架":e.sort((s,t)=>t.time-s.time);break;case"收藏最多":e.sort((s,t)=>t.fav-s.fav);break}return e}),{visibleList:q,isLoading:oe,noMore:ie,sentinel:le}=Y(ae,{batchSize:12}),{visibleList:z,isLoading:re,noMore:ce,sentinel:ne}=Y(f,{batchSize:12}),B=e=>{sessionStorage.setItem("search-main-return-tabType",p.value),sessionStorage.setItem("search-main-return-tab",n.value),sessionStorage.setItem("search-main-scroll-top",window.scrollY.toString()),n.value==="小说"?k.push({name:"NovelDetail",params:{id:e.id}}):n.value==="动漫"?k.push({path:"/animeDetail",query:{id:e.id,title:e.title}}):n.value==="有声"?k.push({path:"/audioDetail",query:{id:e.id,title:e.title}}):k.push({name:"ComicDetail",params:{id:e.id},query:{type:"comic"}})},ue=()=>{const e=sessionStorage.getItem("search-entry-from");e?(sessionStorage.removeItem("search-entry-from"),k.replace(e)):k.replace({name:"Acg"})};return ze(async()=>{await A();const e=sessionStorage.getItem("search-main-return-tabType"),s=sessionStorage.getItem("search-main-return-tab"),t=sessionStorage.getItem("search-main-scroll-top");e&&s?(p.value=e,n.value=s,await N(n.value,!0),await A(),t&&window.scrollTo(0,parseInt(t,10)),sessionStorage.removeItem("search-main-return-tabType"),sessionStorage.removeItem("search-main-return-tab"),sessionStorage.removeItem("search-main-scroll-top")):await N(n.value,!1)}),(e,s)=>(i(),o("div",Ge,[a("div",Qe,[a("div",{class:"back-btn",onClick:ue},s[3]||(s[3]=[a("img",{src:Je,alt:"返回"},null,-1)])),a("div",Xe,[a("div",{class:w(["tab-item",{active:p.value==="search"}]),onClick:s[0]||(s[0]=t=>$("search"))},"搜一搜",2),a("div",{class:w(["tab-item",{active:p.value==="library"}]),onClick:s[1]||(s[1]=t=>$("library"))},y(O[n.value]?O[n.value]+"库":"漫画库"),3)])]),p.value==="search"?(i(),o(d,{key:0},[a("div",Ze,[a("div",es,[s[4]||(s[4]=a("img",{src:Ue,class:"search-icon"},null,-1)),Be(a("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=t=>v.value=t),onInput:Z,placeholder:"请输入要搜索的内容"},null,544),[[He,v.value]])]),a("div",{class:"search-btn",onClick:T},"搜索")]),b.value?(i(),o(d,{key:0},[f.value.length>0?(i(),o("div",ss,[P(W,{layoutType:"type5",data:g(z).value||[],onItemClick:B},null,8,["data"]),g(re)?(i(),o("div",ts,s[5]||(s[5]=[a("img",{src:F,alt:"加载中...",class:"custom-spinner"},null,-1),a("div",{class:"loading-text"},"客官别走，妾身马上就好~",-1)]))):h("",!0),g(ce)&&g(z).length>0?(i(),o("div",as," 客官，妾身被你弄高潮了，扛不住了 ~ ")):h("",!0),a("div",{ref_key:"searchSentinel",ref:ne,class:"load-more-trigger"},null,512)])):(i(),o("div",{key:1,class:"empty-box",onClick:T},s[6]||(s[6]=[a("img",{src:Ee,class:"empty-img"},null,-1),a("div",{class:"empty-text"},"什么都木有，点击重试～",-1)])))],64)):(i(),o(d,{key:1},[_.value.length>0?(i(),o("div",os,[a("div",{class:"history-header"},[s[8]||(s[8]=a("div",{class:"history-title"},"历史搜索",-1)),a("div",{class:"clear-btn",onClick:X},s[7]||(s[7]=[a("img",{src:Fe,class:"delete-icon"},null,-1),E(" 清除全部记录 ")]))]),a("div",is,[(i(!0),o(d,null,I(_.value,(t,l)=>(i(),o("div",{class:"history-tag",key:l,onClick:m=>Q(t)},y(t),9,ls))),128))])])):h("",!0),a("div",rs,[a("div",cs,[s[9]||(s[9]=a("div",{class:"hot-title"},[a("img",{src:We,class:"hot-icon"}),E(" 热门标签 ")],-1)),a("div",ns,[(i(!0),o(d,null,I(g(Ye)[n.value]||[],(t,l)=>(i(),o("div",{key:t,class:"tag-item",onClick:m=>ee(t)},[a("span",{class:w(["tag-num","num-"+(l+1)])},y(l+1),3),a("span",vs,y(t),1)],8,us))),128))])])])],64))],64)):h("",!0),p.value==="library"?(i(),o(d,{key:1},[a("div",ms,[a("div",_s,[a("div",ds,[(i(!0),o(d,null,I(L.value,t=>(i(),o("div",{key:t.key,class:w(["filter-tag",{active:C.value.key===t.key}]),onClick:l=>C.value=t},y(t.label),11,gs))),128))])]),a("div",ps,[a("div",fs,[(i(!0),o(d,null,I(se.value,t=>(i(),o("div",{key:t,class:w(["filter-tag",{active:S.value===t}]),onClick:l=>S.value=t},y(t),11,hs))),128))])]),a("div",ys,[a("div",ks,[(i(!0),o(d,null,I(te.value,t=>(i(),o("div",{key:t,class:w(["filter-tag",{active:x.value===t}]),onClick:l=>x.value=t},y(t),11,bs))),128))])])]),P(W,{layoutType:"type5",data:g(q).value||[],onItemClick:B},null,8,["data"]),g(oe)?(i(),o("div",ws,s[10]||(s[10]=[a("img",{src:F,alt:"加载中...",class:"custom-spinner"},null,-1),a("div",{class:"loading-text"},"客官别走，妾身马上就好~",-1)]))):h("",!0),g(ie)&&g(q).length>0?(i(),o("div",Cs," 客官，妾身被你弄高潮了，扛不住了 ~ ")):h("",!0),a("div",{ref_key:"sentinel",ref:le,class:"load-more-trigger"},null,512)],64)):h("",!0)]))}}),Gs=Pe(Ss,[["__scopeId","data-v-fd2716f7"]]);export{Gs as default};
