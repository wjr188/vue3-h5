import{d as H,u as J,r as _,q as E,o as Q,k as y,s as Z,c as p,a as d,b as t,W as K,v as C,t as n,F as I,e as R,f as X,h as D,m as Y,j as tt,x as et,p as l,n as st}from"./index-CKjozqaQ.js";import{_ as ot}from"./1-fzo8JEYb.js";import{_ as at}from"./10-CgmEdRt1.js";import{_ as it}from"./11-CabwFj8e.js";import{_ as rt}from"./2-CuUYKjVo.js";import{_ as ct}from"./3-CDSPaFCZ.js";import{_ as lt}from"./4-DpjjeBM5.js";import{_ as nt}from"./5-BY--KaCV.js";import{_ as mt}from"./6-BUa2zK63.js";import{_ as _t}from"./7-6vga_5yu.js";import{_ as dt}from"./8-0KauOiHy.js";import{_ as ut}from"./9-laFEHVAn.js";import{_ as pt}from"./1-V7LAkzHJ.js";import{_ as L}from"./dynamic-import-helper-BheWnx7M.js";import{_ as vt}from"./back3-q87-H97k.js";import{_ as gt}from"./share2-DEdzc1xC.js";import{_ as A}from"./AcgCard-BM0gqaW9.js";import{_ as ht}from"./refresh-C6sFfBRw.js";import{C as ft}from"./ChapterDrawer-CFwy4oMB.js";import{A as kt}from"./AcgSection-Cuw1vH7V.js";import{_ as yt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./play4-3PhygbDH.js";import"./swiper.min-DhCtGxFp.js";const Tt=""+new URL("../icons/like2.svg",import.meta.url).href,bt=""+new URL("../icons/collect.svg",import.meta.url).href,wt=""+new URL("../icons/view-all-icon.svg",import.meta.url).href,jt=""+new URL("../icons/star2.svg",import.meta.url).href,Et={class:"comic-detail-wrapper"},Ct={class:"header-content"},It={class:"cover-info"},Rt={class:"cover-img"},Dt={class:"info-text"},Lt={class:"title"},At={class:"sub-info"},Vt={class:"episode"},Ot={class:"category"},Pt={class:"intro"},St={class:"tags"},$t={class:"stats-full-width"},Nt={class:"stats-left"},xt={class:"stat-item"},Mt={class:"stats-center"},qt={class:"stat-item"},Bt={class:"collect-badge"},Ft={class:"badge-content"},Ut={class:"badge-text"},zt={class:"tabs-section-single"},Gt={class:"tab-item-single active"},Wt={class:"content"},Ht={class:"chapter-header-new"},Jt={class:"chapter-title-wrapper"},Qt={class:"chapter-episode-tag"},Zt={class:"chapter-list"},Kt=["onClick"],Xt={class:"chapter-cover-new"},Yt={class:"chapter-info"},te={class:"chapter-title"},ee={class:"read-btn"},se={class:"guess-like-wrapper"},oe={class:"guess-like-section"},ae={class:"bottom-bar"},V=9,ie=H({__name:"ComicDetail",props:{id:{},type:{default:"comic"}},setup(O){const c=O,m=J(),P=Object.assign({"/src/mock/acg/comic/detail/1.js":ot,"/src/mock/acg/comic/detail/10.js":at,"/src/mock/acg/comic/detail/11.js":it,"/src/mock/acg/comic/detail/2.js":rt,"/src/mock/acg/comic/detail/3.js":ct,"/src/mock/acg/comic/detail/4.js":lt,"/src/mock/acg/comic/detail/5.js":nt,"/src/mock/acg/comic/detail/6.js":mt,"/src/mock/acg/comic/detail/7.js":_t,"/src/mock/acg/comic/detail/8.js":dt,"/src/mock/acg/comic/detail/9.js":ut}),S=Object.assign({"/src/mock/acg/novel/detail/1.js":pt}),i=_({id:"",title:"",cover:"",intro:"",category:"",views:0,likes:0,status:"free",tags:[],chapters:[],episodeCount:0}),g=_(!1),T=_(!1),u=_(null),h=_([]),b=_([]),$=_(0);function N(){let s=[];c.type==="comic"?s=Object.values(P).map(e=>e.default).filter(e=>e.category===i.value.category&&e.id!==i.value.id):c.type==="novel"&&(s=Object.values(S).map(e=>e.default).filter(e=>e.category===i.value.category&&e.id!==i.value.id)),b.value=s,w()}function w(){const s=b.value;if(s.length<=V){h.value=Array.from(new Map(s.map(o=>[o.id,o])).values());return}let e=Array.from(new Map(s.map(o=>[o.id,o])).values()),a=[],r=e.slice();for(let o=0;o<V&&r.length!==0;o++){const v=Math.floor(Math.random()*r.length);a.push(r.splice(v,1)[0])}h.value=a}function x(){w()}function M(s){c.type==="novel"?m.push({name:"NovelDetail",params:{id:s.id}}):c.type==="comic"?m.push({name:"ComicDetail",params:{id:s.id},query:{type:"comic"}}):c.type==="anime"?m.push({path:"/animeDetail",query:{id:s.id,title:s.title}}):c.type==="audio"&&m.push({path:"/audioDetail",query:{id:s.id,title:s.title}})}const q=()=>{g.value=!0},B=E(()=>T.value||i.value.chapters.length<=3?i.value.chapters:[...i.value.chapters].sort((e,a)=>e.id-a.id).slice(0,3)),F=E(()=>i.value.chapters.length>3&&!T.value&&!g.value);function U(s){switch(s.status){case"vip":return"VIP";case"coin":return`${s.price||0}金币`;case"free":default:return"免费"}}function f(s){u.value=s,localStorage.setItem(`lastReadChapter_${c.id}`,s.toString());const e=c.type==="novel"?"NovelReader":"ComicReader";m.push({name:e,params:{comicId:c.id,chapterId:s}})}async function z(s,e,a){if(c.type==="novel")return a;try{const o=(await L(Object.assign({"../mock/acg/comic/chapter/1_1.js":()=>l(()=>import("./1_1-DTCd7SiF.js"),[],import.meta.url),"../mock/acg/comic/chapter/1_2.js":()=>l(()=>import("./1_2-zZQJg1jI.js"),[],import.meta.url),"../mock/acg/comic/chapter/1_3.js":()=>l(()=>import("./1_3-DTCd7SiF.js"),[],import.meta.url),"../mock/acg/novel/chapter/1_1.js":()=>l(()=>import("./1_1-CWkr6Efs.js"),[],import.meta.url),"../mock/acg/novel/chapter/1_2.js":()=>l(()=>import("./1_2-BC80yQ9J.js"),[],import.meta.url),"../mock/acg/novel/chapter/1_3.js":()=>l(()=>import("./1_3-DCkJVmNu.js"),[],import.meta.url),"../mock/acg/novel/chapter/1_4.js":()=>l(()=>import("./1_4-kvWg1Odv.js"),[],import.meta.url),"../mock/acg/novel/chapter/1_5.js":()=>l(()=>import("./1_5-QhUkCZb-.js"),[],import.meta.url)}),`../mock/acg/${c.type}/chapter/${s}_${e}.js`,6)).default.images||[];return o[4]||o[0]||a}catch{return a}}async function j(s){try{const a=(await L(Object.assign({"../mock/acg/comic/detail/1.js":()=>l(()=>import("./1-fzo8JEYb.js").then(o=>o._),[],import.meta.url),"../mock/acg/comic/detail/10.js":()=>l(()=>import("./10-CgmEdRt1.js").then(o=>o._),[],import.meta.url),"../mock/acg/comic/detail/11.js":()=>l(()=>import("./11-CabwFj8e.js").then(o=>o._),[],import.meta.url),"../mock/acg/comic/detail/2.js":()=>l(()=>import("./2-CuUYKjVo.js").then(o=>o._),[],import.meta.url),"../mock/acg/comic/detail/3.js":()=>l(()=>import("./3-CDSPaFCZ.js").then(o=>o._),[],import.meta.url),"../mock/acg/comic/detail/4.js":()=>l(()=>import("./4-DpjjeBM5.js").then(o=>o._),[],import.meta.url),"../mock/acg/comic/detail/5.js":()=>l(()=>import("./5-BY--KaCV.js").then(o=>o._),[],import.meta.url),"../mock/acg/comic/detail/6.js":()=>l(()=>import("./6-BUa2zK63.js").then(o=>o._),[],import.meta.url),"../mock/acg/comic/detail/7.js":()=>l(()=>import("./7-6vga_5yu.js").then(o=>o._),[],import.meta.url),"../mock/acg/comic/detail/8.js":()=>l(()=>import("./8-0KauOiHy.js").then(o=>o._),[],import.meta.url),"../mock/acg/comic/detail/9.js":()=>l(()=>import("./9-laFEHVAn.js").then(o=>o._),[],import.meta.url),"../mock/acg/novel/detail/1.js":()=>l(()=>import("./1-V7LAkzHJ.js").then(o=>o._),[],import.meta.url)}),`../mock/acg/${c.type}/detail/${s}.js`,6)).default,r=await Promise.all((a.chapters||[]).map(async o=>{let v=a.cover;return c.type!=="novel"&&(v=await z(s,o.id,a.cover)),{...o,title:o.title||`第${o.id}话`,cover:v}}));i.value={id:a.id,title:a.title,cover:a.cover,intro:a.intro,category:a.category,views:a.views||0,likes:a.likes||0,status:a.status||"free",tags:a.tags||[],chapters:r,episodeCount:r.length}}catch(e){console.error("[加载数据] 加载失败:",e),i.value={id:s,title:"漫画未找到",chapters:[],episodeCount:0}}}Q(()=>{j(c.id);const s=localStorage.getItem(`lastReadChapter_${c.id}`);s&&(u.value=parseInt(s,10))}),y(()=>c.id,s=>{j(s),u.value=null;const e=localStorage.getItem(`lastReadChapter_${s}`);e&&(u.value=parseInt(e,10))}),y(u,s=>{s!==null?localStorage.setItem(`lastReadChapter_${c.id}`,s.toString()):localStorage.removeItem(`lastReadChapter_${c.id}`)}),y(()=>[i.value.category,c.type,i.value.id],([s,e,a])=>{!s||!a||($.value=0,N())},{immediate:!0});function G(){const s=sessionStorage.getItem("search-main-return-tab"),e=sessionStorage.getItem("search-main-scroll-top");if(s){m.replace({name:"SearchMainPage",query:{activeTab:s,scrollTop:e}});return}const a=sessionStorage.getItem("acg-return-from"),r=sessionStorage.getItem("acg-scroll-top");if(a){let o=a;try{o=JSON.parse(a)}catch{}m.replace(o).then(()=>{st(()=>{requestAnimationFrame(()=>{window.scrollTo(0,parseInt(r||"0",10))})})}),sessionStorage.removeItem("acg-return-from"),sessionStorage.removeItem("acg-scroll-top")}else m.back()}function k(s){return!s||isNaN(s)?"0.0w":(s/1e4).toFixed(1).replace(/\.0$/,"")+"w"}function W(){m.push("/promotion-share")}return(s,e)=>{const a=Z("lazy");return d(),p("div",Et,[t("div",{class:"top-bar"},[t("img",{src:vt,class:"back-icon",onClick:G}),t("img",{src:gt,class:"share-icon",onClick:W})]),t("div",{class:"header",style:X({backgroundImage:"url("+i.value.cover+")"})},[e[2]||(e[2]=t("div",{class:"header-mask"},null,-1)),t("div",Ct,[t("div",It,[C(t("img",Rt,null,512),[[a,i.value.cover]]),t("div",Dt,[t("h2",Lt,n(i.value.title),1),t("div",At,[t("span",Vt,"共"+n(i.value.episodeCount)+"话",1),t("span",Ot,n(i.value.category),1)])])]),t("p",Pt,n(i.value.intro),1),t("div",St,[(d(!0),p(I,null,R(i.value.tags,r=>(d(),p("span",{class:"tag",key:r},n(r),1))),128))])])],4),t("div",$t,[t("div",Nt,[t("div",xt,[e[3]||(e[3]=t("img",{src:A,class:"stat-icon"},null,-1)),t("span",null,n(k(i.value.views)),1)])]),t("div",Mt,[t("div",qt,[e[4]||(e[4]=t("img",{src:Tt,class:"stat-icon"},null,-1)),t("span",null,n(k(i.value.likes)),1)])]),t("div",Bt,[t("div",Ft,[e[5]||(e[5]=t("img",{src:bt,class:"badge-icon"},null,-1)),t("div",Ut,n(k(i.value.likes))+"人收藏",1)])])]),e[13]||(e[13]=K('<div class="promo-section-full-width" data-v-5791072a><div class="promo-text" data-v-5791072a>新用户首充特惠</div><div class="promo-countdown" data-v-5791072a><span class="countdown-segment" data-v-5791072a>23</span><span class="countdown-colon" data-v-5791072a>:</span><span class="countdown-segment" data-v-5791072a>59</span><span class="countdown-colon" data-v-5791072a>:</span><span class="countdown-segment" data-v-5791072a>15</span></div><button class="promo-read-btn" data-v-5791072a>立即开通</button></div>',1)),t("div",zt,[t("div",Gt,n(c.type==="novel"?"小说详情":"漫画详情"),1)]),t("div",Wt,[t("div",Ht,[t("div",Jt,[e[6]||(e[6]=t("span",{class:"chapter-text"},"目录",-1)),t("span",Qt,"共"+n(i.value.episodeCount)+"话",1)])]),t("div",Zt,[(d(!0),p(I,null,R(B.value,r=>(d(),p("div",{class:"chapter-item",key:r.id,onClick:o=>f(r.id)},[C(t("img",Xt,null,512),[[a,r.cover]]),t("div",Yt,[t("div",te,n(r.title),1)]),t("button",ee,n(r.id===u.value?"上次":U(r)),1)],8,Kt))),128))]),F.value?(d(),p("div",{key:0,class:"view-all-chapters",onClick:q},e[7]||(e[7]=[t("img",{src:wt,class:"view-all-icon"},null,-1),t("span",null,"查看全部目录",-1)]))):D("",!0),Y(ft,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=r=>g.value=r),chapters:i.value.chapters,"comic-id":i.value.id,"comic-title":i.value.title,type:c.type,cover:i.value.cover,fullScreen:!0,onReadChapterFromDrawer:f},null,8,["modelValue","chapters","comic-id","comic-title","type","cover"]),t("div",se,[e[10]||(e[10]=t("div",{class:"guess-like-wave-wrapper"},[t("svg",{viewBox:"0 0 1440 40",preserveAspectRatio:"none"},[t("path",{d:"M0,30 Q30,10 60,30 T120,30 T180,30 T240,30 T300,30 T360,30 T420,30 T480,30 T540,30 T600,30 T660,30 T720,30 T780,30 T840,30 T900,30 T960,30 T1020,30 T1080,30 T1140,30 T1200,30 T1260,30 T1320,30 T1380,30 T1440,30 L1440,0 L0,0 Z",fill:"#ffffff"})])],-1)),t("div",oe,[e[9]||(e[9]=t("div",{class:"guess-like-title"},"看了又看",-1)),h.value.length>0?(d(),tt(kt,{key:0,layoutType:"type4",data:h.value,onItemClick:M},null,8,["data"])):D("",!0),t("div",{class:"change-btn-wrapper"},[t("div",{class:"change-btn",onClick:x},e[8]||(e[8]=[t("img",{src:ht,class:"refresh-icon"},null,-1),et(" 换一批 ")]))])])]),t("div",ae,[e[12]||(e[12]=t("button",{class:"bottom-left-btn"},[t("img",{src:jt,class:"bottom-icon-large"}),t("div",{class:"bottom-icon-text"},"收藏")],-1)),t("button",{class:"bottom-read-btn-big",onClick:e[1]||(e[1]=r=>f(i.value.chapters[0]?.id))},e[11]||(e[11]=[t("img",{src:A,class:"bottom-icon-small"},null,-1),t("span",null,"开始阅读",-1)]))])])])}}}),De=yt(ie,[["__scopeId","data-v-5791072a"]]);export{De as default};
